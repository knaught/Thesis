<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Robot Mapper: src/RmJavaGridModel.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">src</a></div>
<h1>RmJavaGridModel.cpp</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">// RmJavaGridModel.cpp</span>
00002 
00003 <span class="preprocessor">#pragma warning( disable : 4786 )</span>
00004 <span class="preprocessor"></span>
00005 <span class="preprocessor">#include &lt;jni.h&gt;</span>
00006 <span class="preprocessor">#include "RmJavaGridModel.h"</span>
00007 
00008 <span class="preprocessor">#include &lt;fstream&gt;</span>
00009 <span class="preprocessor">#include &lt;iostream&gt;</span>
00010 <span class="preprocessor">#include "RmSonarMapper.h"</span>
00011 <span class="preprocessor">#include "RmSettings.h"</span>
00012 <span class="preprocessor">#include "RmUtility.h"</span>
00013 <span class="preprocessor">#include "RmPioneerController.h"</span>
00014 <span class="preprocessor">#include "RmExceptions.h"</span>
00015 <span class="preprocessor">#include "RmGlobalMap.h"</span>
00016 
00017 <span class="keyword">static</span> std::ifstream g_ifStream;
00018 <span class="keyword">static</span> std::ofstream g_ofStream;
00019 <span class="keyword">static</span> <span class="keywordtype">int</span> g_dataSource;
00020 <span class="keyword">static</span> <span class="keywordtype">int</span> g_sonarNumber = 0;
00021 
00022 <a class="code" href="structRmSettings.html">RmSettings</a> g_settings;
00023 <a class="code" href="classRmGlobalMap.html">RmGlobalMap</a> g_grid( &amp;g_settings );
00024 std::vector&lt;RmActionHandler*&gt; g_actionHandlers;
00025 <a class="code" href="classRmSonarMapper.html">RmSonarMapper</a> g_sonarMapper( g_settings, &amp;g_grid );
00026 
00027 
00028 <span class="keyword">struct </span>Listener
00029 {
00030         jobject object;
00031         jmethodID methodID;
00032 };
00033 
00034 <span class="keyword">static</span> JNIEnv* s_env = NULL;
00035 <span class="keyword">static</span> Listener* s_listener = NULL;
00036 ArRobot* g_robot;
00037 
00038 
00039 <span class="keywordtype">void</span> fireMapUpdateEvent( std::string eventString )
00040 {
00041         <span class="keywordflow">if</span> ( s_env != NULL &amp;&amp; s_listener != NULL ) {
00042                 jstring jstr = s_env-&gt;NewStringUTF( eventString.c_str() );
00043                 s_env-&gt;CallVoidMethod( s_listener-&gt;object, s_listener-&gt;methodID, jstr );
00044         }
00045 }
00046 
00047 
00048 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00049 Java_GridModel_setMapUpdateListener( JNIEnv *env, jobject obj, jobject listener )
00050 {
00051         s_env = env;
00052         jclass cls = env-&gt;GetObjectClass( listener );
00053         jmethodID mid = env-&gt;GetMethodID( cls, <span class="stringliteral">"mapUpdateFired"</span>, <span class="stringliteral">"(Ljava/lang/String;)V"</span> );
00054         <span class="keywordflow">if</span> ( mid != NULL ) 
00055         {
00056                 <span class="comment">// Install listener</span>
00057                 s_listener = <span class="keyword">new</span> Listener();
00058                 s_listener-&gt;object = obj;
00059                 s_listener-&gt;methodID = mid;
00060         }
00061         <span class="keywordflow">else</span> {
00062                 printf( <span class="stringliteral">"Java_GridModel_setMapUpdateListener(): Unable to install listener.\n"</span> );
00063         }
00064 }
00065 
00066 
00067 JNIEXPORT jint JNICALL
00068 Java_GridModel_openLiveConnection( JNIEnv *env, jobject obj, jstring filename, jboolean wander )
00069 {
00070         <span class="keyword">const</span> <span class="keywordtype">char</span> *cfilename = env-&gt;GetStringUTFChars( filename, 0 );
00071 
00072         <span class="keywordflow">try</span> {
00073                 <span class="comment">// Open log file for write</span>
00074                 g_ofStream.open( cfilename );
00075                 <span class="keywordflow">if</span> ( !g_ofStream.good() ) {
00076                         <span class="keywordflow">throw</span> <a class="code" href="structRmExceptions_1_1IOException.html">RmExceptions::IOException</a>( <span class="stringliteral">"Java_GridModel_openLiveConnection()"</span>, 
00077                                 <span class="stringliteral">"Unable to open sonar output file."</span> );
00078                 }
00079 
00080                 <a class="code" href="classRmSonarMapper.html">RmSonarMapper</a>* sonarRecorder = <span class="keyword">new</span> <a class="code" href="classRmSonarMapper.html">RmSonarMapper</a>( g_settings, g_ofStream, &amp;g_grid );
00081                 g_actionHandlers.empty();
00082                 g_actionHandlers.push_back( sonarRecorder );
00083                 <a class="code" href="classRmPioneerController.html">RmPioneerController</a> robot( <span class="keyword">false</span>, <span class="keyword">true</span>, &amp;g_actionHandlers );
00084                 <span class="keywordflow">if</span> ( robot.getConnectionStatus() == RmPioneerController::FAILED ) {
00085                         <span class="keywordflow">throw</span> <a class="code" href="structRmExceptions_1_1Exception.html">RmExceptions::Exception</a>( NULL, <span class="stringliteral">"Java_GridModel_openLiveConnection()"</span>, 
00086                                 <span class="stringliteral">"Unable to establish connection with simulator or robot."</span> );
00087                 }
00088         }
00089         <span class="keywordflow">catch</span>( <a class="code" href="structRmExceptions_1_1Exception.html">RmExceptions::Exception</a> e ) {
00090                 env-&gt;ReleaseStringUTFChars( filename, cfilename );
00091                 std::cerr &lt;&lt; e &lt;&lt; <span class="stringliteral">"\n"</span>;
00092                 <span class="keywordflow">return</span> 1;
00093         }
00094 
00095         <span class="keywordflow">return</span> 0;
00096 }
00097 
00098 
00099 JNIEXPORT jint JNICALL  <span class="comment">// openConnection( const char* filename )</span>
00100 Java_GridModel_openFileConnection( JNIEnv *env, jobject obj, jstring filename )
00101 {
00102         <span class="keyword">const</span> <span class="keywordtype">char</span> *cfilename = env-&gt;GetStringUTFChars( filename, 0 );
00103         <span class="keywordflow">try</span> {
00104                 <span class="keywordflow">if</span> ( g_ifStream.is_open() ) g_ifStream.close();
00105                 g_ifStream.open( cfilename );
00106                 <span class="keywordflow">if</span> ( !g_ifStream.good() ) <span class="keywordflow">throw</span> <a class="code" href="structRmExceptions_1_1IOException.html">RmExceptions::IOException</a>( 
00107                         <span class="stringliteral">"Java_GridModel_openFileConnection()"</span>, <span class="stringliteral">"Unable to open input file."</span> );
00108         }
00109         <span class="keywordflow">catch</span>( <a class="code" href="structRmExceptions_1_1Exception.html">RmExceptions::Exception</a> e ) {
00110                 env-&gt;ReleaseStringUTFChars( filename, cfilename );
00111                 std::cerr &lt;&lt; e &lt;&lt; <span class="stringliteral">"\n"</span>;
00112                 <span class="keywordflow">return</span> 1;
00113         }
00114         
00115         <span class="keywordflow">return</span> 0;
00116 }
00117 
00118 
00119 JNIEXPORT jint JNICALL 
00120 Java_GridModel_resetFileConnection( JNIEnv *env, jobject obj )
00121 {
00122         <span class="keywordflow">try</span> {
00123                 g_ifStream.clear();
00124                 <span class="keywordflow">if</span> ( !g_ifStream.is_open() ) <span class="keywordflow">throw</span> <a class="code" href="structRmExceptions_1_1IOException.html">RmExceptions::IOException</a>( 
00125                         <span class="stringliteral">"Java_GridModel_resetFileConnection()"</span>, <span class="stringliteral">"Connection not open."</span> );
00126                 g_ifStream.seekg( 0 );
00127                 <span class="keywordflow">if</span> ( !g_ifStream.good() ) <span class="keywordflow">throw</span> <a class="code" href="structRmExceptions_1_1IOException.html">RmExceptions::IOException</a>( 
00128                         <span class="stringliteral">"Java_GridModel_resetFileConnection()"</span>, <span class="stringliteral">"Connection reset failed."</span> );
00129         }
00130         <span class="keywordflow">catch</span>( <a class="code" href="structRmExceptions_1_1Exception.html">RmExceptions::Exception</a> e ) {
00131                 std::cerr &lt;&lt; e &lt;&lt; <span class="stringliteral">"\n"</span>;
00132                 <span class="keywordflow">return</span> 1;
00133         }
00134 
00135         g_grid.<a class="code" href="classRmGlobalMap.html#a3">empty</a>();
00136         g_sonarNumber = 0;
00137 
00138         <span class="keywordflow">return</span> 0;
00139 }
00140 
00141 
00142 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00143 Java_GridModel_clearMap( JNIEnv *env, jobject obj )
00144 {
00145         g_grid.<a class="code" href="classRmGlobalMap.html#a1">clear</a>();
00146 }
00147 
00148 
00149 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00150 Java_GridModel_emptyMap( JNIEnv *env, jobject obj )
00151 {
00152         g_grid.<a class="code" href="classRmGlobalMap.html#a3">empty</a>();
00153         g_sonarMapper.<a class="code" href="classRmSonarMapper.html#a3">reset</a>();
00154 }
00155 
00156 
00157 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00158 Java_GridModel_runMapper( JNIEnv *env, jobject obj )
00159 {
00160         <span class="keywordflow">if</span> ( !g_ofStream.is_open() ) {
00161                 std::cerr &lt;&lt; <span class="stringliteral">"Java_GridModel_runMapper(): Connection not open.\n"</span>;
00162                 <span class="keywordflow">return</span>;
00163         }
00164 
00165         <span class="comment">// Start 'er up!</span>
00166         <span class="keywordflow">if</span> ( g_robot ) {
00167                 g_robot-&gt;setVel( 40.0 );
00168                 g_robot-&gt;runAsync( <span class="keyword">true</span> );
00169         }
00170 }
00171 
00172 
00177 std::ifstream &amp;getLine( std::ifstream &amp;is, <span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> size )
00178 {
00179         <span class="keywordflow">do</span> <span class="keywordflow">if</span> ( !is.getline( buffer, size ) ) <span class="keywordflow">break</span>;
00180         <span class="keywordflow">while</span> ( buffer[0] == <span class="charliteral">'%'</span> ); <span class="comment">// skip comments</span>
00181 
00182         <span class="keywordflow">return</span> is;
00183 }
00184 
00185 
00192 std::string getLine( std::ifstream &amp;is )
00193 {
00194         <span class="keyword">const</span> <span class="keywordtype">int</span> BufSize = 120;
00195         <span class="keywordtype">char</span> buff[BufSize];
00196         std::string line;
00197 
00198         <span class="comment">// get next non-comment line</span>
00199         <span class="keywordflow">do</span> 
00200         {
00201                 is.getline( buff, BufSize );
00202 
00203                 <span class="comment">// get one newline-terminated line of unspecified length</span>
00204                 <span class="keywordflow">while</span> ( !is.eof() ) 
00205                 {
00206                         line.append( buff );
00207 
00208                         <span class="comment">// bolt if we've read end of line (vice hitting buffer size)</span>
00209                         <span class="keywordflow">if</span> ( is.gcount() &lt; BufSize - 2 ) <span class="keywordflow">break</span>;
00210 
00211                         <span class="comment">// for gcount() of 118, 119, or 120, newline is next character</span>
00212                         <span class="keywordflow">if</span> ( is.peek() == <span class="charliteral">'\n'</span> ) <span class="keywordflow">break</span>;
00213 
00214                         <span class="comment">// flags are raised when BufSize is reached; ignore them</span>
00215                         is.clear();
00216 
00217                         is.getline( buff, BufSize, <span class="charliteral">'\n'</span> );
00218                 }
00219 
00220         } <span class="keywordflow">while</span> ( !is.eof() &amp;&amp; line[0] == <span class="charliteral">'%'</span> );
00221 
00222         <span class="keywordflow">return</span> line;
00223 }
00224 
00225 
00230 JNIEXPORT jstring JNICALL
00231 Java_GridModel_stepSonarMapper( JNIEnv *env, jobject obj )
00232 {
00233         <span class="comment">// This routine statically stores a single line of sonar data</span>
00234         <span class="comment">// and then iterates through the range readings each time it is called.</span>
00235 
00236         <span class="keywordflow">if</span> ( !g_ifStream.is_open() ) {
00237                 std::cerr &lt;&lt; <span class="stringliteral">"Java_GridModel_stepMapper(): Connection not open.\n"</span>;
00238                 <span class="keywordflow">return</span> NULL;
00239         }
00240 
00241         <span class="keyword">static</span> <a class="code" href="structRmUtility_1_1SonarReading.html">RmUtility::SonarReading</a> reading;
00242 
00243         <span class="comment">// Repeat until in-range sonar reading is found or end of file is hit</span>
00244         std::string dataString;
00245         <span class="keywordflow">do</span> {
00246                 <span class="comment">// If looking for first sonar reading, process a new line of data</span>
00247                 <span class="keywordflow">if</span> ( g_sonarNumber == 0 ) 
00248                 {
00249                         <span class="keywordtype">char</span> buffer[120];
00250                         <span class="keywordflow">if</span> ( !getLine( g_ifStream, buffer, 120 ) ) <span class="keywordflow">return</span> NULL;
00251 
00252                         <span class="comment">// Extract SonarReading</span>
00253                         reading = <a class="code" href="structRmUtility_1_1SonarReading.html">RmUtility::SonarReading</a>( buffer );
00254                 }
00255 
00256                 <span class="comment">// Map single sonar reading</span>
00257                 <span class="keywordflow">try</span> {
00258                         dataString = g_sonarMapper.<a class="code" href="classRmSonarMapper.html#a1">mapReading</a>( &amp;reading, g_sonarNumber );
00259                 } <span class="keywordflow">catch</span> ( <a class="code" href="structRmExceptions_1_1Exception.html">RmExceptions::Exception</a> e ) {
00260                         std::cerr &lt;&lt; <span class="stringliteral">"Exception caught in Java_GridModel_stepSonarMapper()\n"</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">"\n"</span>;
00261                         <span class="keywordflow">throw</span>; <span class="comment">// force JVM to crash</span>
00262                 }
00263 
00264                 <span class="comment">// Move to the next range reading</span>
00265                 <span class="keywordflow">if</span> ( ++g_sonarNumber &gt; 15 ) g_sonarNumber = 0;
00266         } <span class="keywordflow">while</span> ( dataString.length() == 0 );
00267 
00268         <span class="keywordflow">return</span> env-&gt;NewStringUTF( dataString.c_str() );
00269 }
00270 
00271 
00277 JNIEXPORT jstring JNICALL
00278 Java_GridModel_stepLogMapper( JNIEnv *env, jobject obj )
00279 {
00280         <span class="keywordflow">if</span> ( !g_ifStream.is_open() ) {
00281                 std::cerr &lt;&lt; <span class="stringliteral">"Java_GridModel_stepLogMapper(): Connection not open.\n"</span>;
00282                 <span class="keywordflow">return</span> NULL;
00283         }
00284 
00285         <span class="comment">// Read next log data entry from file</span>
00286         std::string dataString;
00287         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; g_ifStream &amp;&amp; i &lt; 3; ++i ) {
00288                 dataString.append( getLine( g_ifStream ) + <span class="stringliteral">"\n"</span> );
00289         }
00290 
00291         <span class="keywordflow">return</span> i != 3 ? NULL : env-&gt;NewStringUTF( dataString.c_str() );
00292 }
00293 
00294 
00300 JNIEXPORT jstring JNICALL
00301 Java_GridModel_localize( JNIEnv *env, jobject obj )
00302 {
00303         <span class="keywordflow">return</span> env-&gt;NewStringUTF( <span class="stringliteral">""</span> );
00304 }
00305 
00306 
00312 JNIEXPORT jstring JNICALL
00313 Java_GridModel_integrate( JNIEnv *env, jobject obj )
00314 {
00315         <span class="keywordflow">return</span> env-&gt;NewStringUTF( <span class="stringliteral">""</span> );
00316 }
00317 
00318 
00319 
00320 JNIEXPORT jint JNICALL
00321 Java_GridModel_saveMap( JNIEnv *env, jobject obj, jstring filename )
00322 {
00323         <span class="keyword">const</span> <span class="keywordtype">char</span> *cfilename = env-&gt;GetStringUTFChars( filename, 0 );
00324         <span class="keywordflow">try</span> {
00325                 <span class="keywordflow">if</span> ( *cfilename == 0 ) <span class="keywordflow">throw</span> <a class="code" href="structRmExceptions_1_1IOException.html">RmExceptions::IOException</a>( 
00326                         <span class="stringliteral">"Java_GridModel_saveMap()"</span>, <span class="stringliteral">"Filename unspecified."</span> );
00327                 std::ofstream fout( cfilename );
00328                 <span class="keywordflow">if</span>( !fout ) <span class="keywordflow">throw</span> <a class="code" href="structRmExceptions_1_1IOException.html">RmExceptions::IOException</a>( 
00329                         <span class="stringliteral">"Java_GridModel_saveMap()"</span>, <span class="stringliteral">"Unable to open output file."</span> );
00330                 g_grid.<a class="code" href="classRmGlobalMap.html#a8">put</a>( fout );
00331                 fout.close();
00332         }
00333         <span class="keywordflow">catch</span>( <a class="code" href="structRmExceptions_1_1Exception.html">RmExceptions::Exception</a> e )      {
00334                 env-&gt;ReleaseStringUTFChars( filename, cfilename );
00335                 std::cerr &lt;&lt; e &lt;&lt; <span class="stringliteral">"\n"</span>;
00336                 <span class="keywordflow">return</span> 1;
00337         }
00338 
00339         <span class="keywordflow">return</span> 0;
00340 }
00341 
00342 
00343 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00344 Java_GridModel_setSonarModel( JNIEnv *env, jobject obj, jint model )
00345 {
00346         g_settings.<a class="code" href="structRmSettings.html#o19">SonarModel</a> = (RmUtility::SonarModelEnum)model;
00347 }
00348 
00349 
00350 JNIEXPORT jint JNICALL
00351 Java_GridModel_getSonarModel( JNIEnv *env, jobject obj )
00352 {
00353         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o19">SonarModel</a>;
00354 }
00355 
00356 
00357 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00358 Java_GridModel_setSonarEnabled( JNIEnv *env, jobject obj, jint sonarNumber, jboolean enabled)
00359 {
00360         g_settings.<a class="code" href="structRmSettings.html#o3">EnabledSonars</a>[sonarNumber] = enabled;
00361 }
00362 
00363 
00364 JNIEXPORT jint JNICALL
00365 Java_GridModel_setCellSize( JNIEnv *env, jobject obj, jint v )
00366 {
00367         <span class="keywordflow">return</span> ( v &lt; 1 || v &gt; 500 ) ? -1 : g_settings.<a class="code" href="structRmSettings.html#o2">CellSize</a> = v;
00368 }
00369 
00370 
00371 JNIEXPORT jint JNICALL
00372 Java_GridModel_getCellSize( JNIEnv *env, jobject obj )
00373 {
00374         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o2">CellSize</a>;
00375 }
00376 
00377 
00378 JNIEXPORT jint JNICALL
00379 Java_GridModel_setSonarBeta( JNIEnv *env, jobject obj, jint v )
00380 {
00381         <span class="keywordflow">return</span> ( v &lt; 7 || v &gt; 90 ) ? -1 : g_settings.<a class="code" href="structRmSettings.html#o1">Beta</a> = v;
00382 }
00383 
00384 
00385 JNIEXPORT jint JNICALL
00386 Java_GridModel_getSonarBeta( JNIEnv *env, jobject obj )
00387 {
00388         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o1">Beta</a>;
00389 }
00390 
00391 
00392 JNIEXPORT jfloat JNICALL
00393 Java_GridModel_setMaxOccupied( JNIEnv *env, jobject obj, jfloat v )
00394 {
00395         <span class="keywordflow">return</span> ( v &lt; 0 || v &gt; 1 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o12">MaxOccupied</a> = v;
00396 }
00397 
00398 
00399 JNIEXPORT jfloat JNICALL
00400 Java_GridModel_getMaxOccupied( JNIEnv *env, jobject obj )
00401 {
00402         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o12">MaxOccupied</a>;
00403 }
00404 
00405 
00406 JNIEXPORT jfloat JNICALL
00407 Java_GridModel_setMaxOccupiedII( JNIEnv *env, jobject obj, jfloat v )
00408 {
00409         <span class="keywordflow">return</span> ( v &lt; 0 || v &gt; 1 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o11">MaxEmpty</a> = v;
00410 }
00411 
00412 
00413 JNIEXPORT jfloat JNICALL
00414 Java_GridModel_getMaxOccupiedII( JNIEnv *env, jobject obj )
00415 {
00416         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o11">MaxEmpty</a>;
00417 }
00418 
00419 
00420 JNIEXPORT jint JNICALL
00421 Java_GridModel_setRegionIWidth( JNIEnv *env, jobject obj, jint v )
00422 {
00423         <span class="keywordflow">return</span> ( v &lt; 1 || v &gt; 1000 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o17">RegionIHalfwidth</a> = v / 2;
00424 }
00425 
00426 
00427 JNIEXPORT jint JNICALL
00428 Java_GridModel_getRegionIWidth( JNIEnv *env, jobject obj )
00429 {
00430         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o17">RegionIHalfwidth</a> * 2;
00431 }
00432 
00433 
00434 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00435 Java_GridModel_setIgnoreOutOfRange( JNIEnv *env, jobject obj, jboolean v )
00436 {
00437         g_settings.<a class="code" href="structRmSettings.html#o6">IgnoreOutOfRange</a> = v;
00438 }
00439 
00440 
00441 JNIEXPORT jboolean JNICALL
00442 Java_GridModel_getIgnoreOutOfRange( JNIEnv *env, jobject obj )
00443 {
00444         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o6">IgnoreOutOfRange</a>;
00445 }
00446 
00447 
00448 JNIEXPORT jint JNICALL
00449 Java_GridModel_setOutOfRangeConversion( JNIEnv *env, jobject obj, jint v )
00450 {
00451         std::cerr &lt;&lt; <span class="stringliteral">"Java_GridModel_setOutOfRangeConversion(): "</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">"\n"</span>;
00452         <span class="keywordflow">return</span> ( v &lt; 1 || v &gt; RmPioneerController::SonarRange ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o15">OutOfRangeConversion</a> = v;
00453 }
00454 
00455 
00456 JNIEXPORT jint JNICALL
00457 Java_GridModel_getOutOfRangeConversion( JNIEnv *env, jobject obj )
00458 {
00459         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o15">OutOfRangeConversion</a>;
00460 }
00461 
00462 
00463 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00464 Java_GridModel_setIgnoreObstructed( JNIEnv *env, jobject obj, jboolean v )
00465 {
00466         g_settings.<a class="code" href="structRmSettings.html#o5">IgnoreObstructed</a> = v;
00467 }
00468 
00469 
00470 JNIEXPORT jboolean JNICALL
00471 Java_GridModel_getIgnoreObstructed( JNIEnv *env, jobject obj )
00472 {
00473         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o5">IgnoreObstructed</a>;
00474 }
00475 
00476 
00477 JNIEXPORT jint JNICALL
00478 Java_GridModel_getLocalMapSize( JNIEnv *env, jobject obj )
00479 {
00480         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o8">LocalMapDistance</a>;
00481 }
00482 
00483 
00484 JNIEXPORT jint JNICALL
00485 Java_GridModel_setLocalMapSize( JNIEnv *env, jobject obj, jint v )
00486 {
00487         <span class="keywordflow">return</span> ( v != 0 &amp;&amp; (v &lt; 100 || v &gt; 25000) ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o8">LocalMapDistance</a> = v;
00488 }
00489 
00490 
00491 JNIEXPORT jboolean JNICALL
00492 Java_GridModel_getLocalizationEnabled( JNIEnv *env, jobject obj )
00493 {
00494         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o7">Localize</a>;
00495 }
00496 
00497 
00498 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00499 Java_GridModel_setLocalizationEnabled( JNIEnv *env, jobject obj, jboolean v )
00500 {
00501         g_settings.<a class="code" href="structRmSettings.html#o7">Localize</a> = v;
00502 }
00503 
00504 
00505 JNIEXPORT jfloat JNICALL
00506 Java_GridModel_getObstructedCertainty( JNIEnv *env, jobject obj )
00507 {
00508         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o14">ObstructedCertainty</a>;
00509 }
00510 
00511 
00512 JNIEXPORT jfloat JNICALL
00513 Java_GridModel_setObstructedCertainty( JNIEnv *env, jobject obj, jfloat v )
00514 {
00515         <span class="keywordflow">return</span> ( v &lt; 0 || v &gt; 1 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o14">ObstructedCertainty</a> = v;
00516 }
00517 
00518 
00519 JNIEXPORT jint JNICALL
00520 Java_GridModel_getMotionMinHeight( JNIEnv *env, jobject obj )
00521 {
00522         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o2">MinHeight</a>;
00523 }
00524 
00525 
00526 JNIEXPORT jint JNICALL
00527 Java_GridModel_setMotionMinHeight( JNIEnv *env, jobject obj, jint v )
00528 {
00529         <span class="keywordflow">return</span> ( v &lt; 0 || v &gt; 50 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o2">MinHeight</a> = v;
00530 }
00531 
00532 
00533 JNIEXPORT jint JNICALL
00534 Java_GridModel_getMotionMinWidth( JNIEnv *env, jobject obj )
00535 {
00536         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o3">MinWidth</a>;
00537 }
00538 
00539 
00540 JNIEXPORT jint JNICALL
00541 Java_GridModel_setMotionMinWidth( JNIEnv *env, jobject obj, jint v )
00542 {
00543         <span class="keywordflow">return</span> ( v &lt; 0 || v &gt; 50 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o3">MinWidth</a> = v;
00544 }
00545 
00546 
00547 JNIEXPORT jint JNICALL
00548 Java_GridModel_getMotionUnitDistance( JNIEnv *env, jobject obj )
00549 {
00550         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o4">UnitDistance</a>;
00551 }
00552 
00553 
00554 JNIEXPORT jint JNICALL
00555 Java_GridModel_setMotionUnitDistance( JNIEnv *env, jobject obj, jint v )
00556 {
00557         <span class="keywordflow">return</span> ( v &lt; 1 || v &gt; 1000 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o4">UnitDistance</a> = v;
00558 }
00559 
00560 
00561 JNIEXPORT jint JNICALL
00562 Java_GridModel_getMotionUnitTurn( JNIEnv *env, jobject obj )
00563 {
00564         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o5">UnitTurn</a>;
00565 }
00566 
00567 
00568 JNIEXPORT jint JNICALL
00569 Java_GridModel_setMotionUnitTurn( JNIEnv *env, jobject obj, jint v )
00570 {
00571         <span class="keywordflow">return</span> ( v &lt; 1 || v &gt; 360 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o5">UnitTurn</a> = v;
00572 }
00573 
00574 
00575 JNIEXPORT jfloat JNICALL
00576 Java_GridModel_getMotionGaussSigma( JNIEnv *env, jobject obj )
00577 {
00578         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o1">GaussianSigma</a>;
00579 }
00580 
00581 
00582 JNIEXPORT jfloat JNICALL
00583 Java_GridModel_setMotionGaussSigma( JNIEnv *env, jobject obj, jfloat v )
00584 {
00585         <span class="keywordflow">return</span> ( v &lt; 0 || v &gt; 100 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o1">GaussianSigma</a> = v;
00586 }
00587 
00588 
00589 JNIEXPORT jfloat JNICALL
00590 Java_GridModel_getMotionBendFactor( JNIEnv *env, jobject obj )
00591 {
00592         <span class="keywordflow">return</span> g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o0">BendFactor</a>;
00593 }
00594 
00595 
00596 JNIEXPORT jfloat JNICALL
00597 Java_GridModel_setMotionBendFactor( JNIEnv *env, jobject obj, jfloat v )
00598 {
00599         <span class="keywordflow">return</span> ( v &lt; 0 || v &gt; 100 ) ? -v : g_settings.<a class="code" href="structRmSettings.html#o13">MotionModel</a>.<a class="code" href="structRmSettings_1_1MotionModelStruct.html#o0">BendFactor</a> = v;
00600 }
00601 
00602 
00603 JNIEXPORT <span class="keywordtype">void</span> JNICALL
00604 Java_GridModel_saveSettings( JNIEnv *env, jobject obj )
00605 {
00606         g_settings.<a class="code" href="structRmSettings.html#a5">write</a>();
00607 }
00608 
00609 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun May 1 23:40:03 2005 for Robot Mapper by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
