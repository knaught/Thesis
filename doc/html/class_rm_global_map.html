<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Robot Mapper: RmGlobalMap Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>RmGlobalMap Class Reference</h1>Provides the mechanism for Bayesian probabilistic mapping of sonar readings into a collection of <a class="el" href="class_rm_local_map.html">RmLocalMap</a> objects, performing real-time localization on them, and integrating them into a single global map.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_rm_global_map_8h-source.html">RmGlobalMap.h</a>&gt;</code>
<p>
<p>Inheritance diagram for RmGlobalMap:
<p><center><img src="class_rm_global_map.png" usemap="#RmGlobalMap_map" border="0" alt=""></center>
<map name="RmGlobalMap_map">
<area href="class_rm_bayes_certainty_grid.html" alt="RmBayesCertaintyGrid" shape="rect" coords="105,112,305,136">
<area href="class_rm_mutable_cartesian_grid.html" alt="RmMutableCartesianGrid< float >" shape="rect" coords="0,56,200,80">
<area href="class_rm_sonar_map.html" alt="RmSonarMap" shape="rect" coords="210,56,410,80">
<area href="class_rm_mutable_matrix.html" alt="RmMutableMatrix< float >" shape="rect" coords="0,0,200,24">
</map>
<a href="class_rm_global_map-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="w0" doxytag="RmGlobalMap::RegionId"></a>
typedef unsigned short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#w0">RegionId</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The data type of the identification number that uniquely identifies each region within the global map. <br></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a0">bound</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the bound of the global map as it exists after integration.  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a1">clear</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets all cells in the global map back to their initialization value, leaving local maps untouched.  <a href="#a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a2">convolvedValueAt</a> (int x, int y) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the value that is the average of all probabilities across the local maps mapped to the given global x-y coordinate.  <a href="#a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a3">empty</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes all local maps and reduces the global map back to its initialization size and state.  <a href="#a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a4">finalize</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs housekeeping on last open local map and integrates all maps into the global map.  <a href="#a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a5">height</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the height of the global map as it exists after integration.  <a href="#a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a6">integrate</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Combines all local maps into a single global map, combining overlapping probabilities as an average.  <a href="#a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a7">obstructionBetween</a> (const <a class="el" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a> &amp;start, const <a class="el" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a> &amp;end) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true if there is a cell with a value of <a class="el" href="struct_rm_settings.html#o14">RmSettings::ObstructedCertainty</a> or greater on the line extending between the <em>scaled</em> start and end coordinates.  <a href="#a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual std::ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a8">put</a> (std::ostream &amp;os) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Inserts a text representation of this object into the given output stream.  <a href="#a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a9">RmGlobalMap</a> (<a class="el" href="struct_rm_settings.html">RmSettings</a> *s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes a 0 x 0 global map with no associated local maps and the given settings.  <a href="#a9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual const std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a10">update</a> (const <a class="el" href="struct_rm_utility_1_1_sonar_reading.html">RmUtility::SonarReading</a> &amp;reading)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Passes the given sonar reading on to the current <a class="el" href="class_rm_local_map.html">RmLocalMap</a>, creating a new local map once the distance specified by <a class="el" href="struct_rm_settings.html#o8">RmSettings::LocalMapDistance</a> has been traveled.  <a href="#a10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a11">width</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the width of the global map as it exists after integration.  <a href="#a11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#a12">~RmGlobalMap</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroys all local maps created via <a class="el" href="class_rm_global_map.html#a10">update()</a>.  <a href="#a12"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b0">addToRegionMap</a> (<a class="el" href="class_rm_local_map.html">RmLocalMap</a> *map)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds the given map to the global region map.  <a href="#b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b1">clearMapString</a> (const <a class="el" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> &amp;bound) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produces a log string that clears all coordinates within the given bound, for use with the map viewer application.  <a href="#b1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b2">deleteRegion</a> (<a class="el" href="struct_rm_global_map_1_1_region.html">Region</a> **const r)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deletes the given region and removes it from the global region map.  <a href="#b2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b3">fillRegionMap</a> (const <a class="el" href="struct_rm_global_map_1_1_region.html">Region</a> *const r, const <a class="el" href="class_rm_global_map.html#w0">RegionId</a> id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fills the area of region r over the global region map with the given id.  <a href="#b3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b4">installNewMap</a> (const <a class="el" href="struct_rm_utility_1_1_sonar_reading.html">RmUtility::SonarReading</a> &amp;reading)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates and adds a new local map to collection of maps, and dispatches any housekeeping chores.  <a href="#b4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b5">integrate</a> (const RmPolygon &amp;bound, bool retVal)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convolves the given local map with the global map.  <a href="#b5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_rm_utility_1_1_pose.html">RmUtility::Pose</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b6">localizedPose</a> (const <a class="el" href="class_rm_local_map.html">RmLocalMap</a> &amp;priorMap, const <a class="el" href="struct_rm_utility_1_1_sonar_reading.html">RmUtility::SonarReading</a> &amp;reading, std::ofstream &amp;log) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the expected robot pose given the reported pose and sonar readings, terminating local map, and global map.  <a href="#b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_rm_global_map_1_1_region.html">Region</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b7">newRegion</a> (const RmPolygon &amp;bound)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a new region over the given bound and adds it to the global region map.  <a href="#b7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rm_global_map.html#b8">removeFromRegionMap</a> (<a class="el" href="class_rm_local_map.html">RmLocalMap</a> *map)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes the given map from the global region map.  <a href="#b8"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Provides the mechanism for Bayesian probabilistic mapping of sonar readings into a collection of <a class="el" href="class_rm_local_map.html">RmLocalMap</a> objects, performing real-time localization on them, and integrating them into a single global map. 
<p>
<h3>Usage</h3>
<p>
A RmGlobalMap may be created and utilized just like a <a class="el" href="class_rm_local_map.html">RmLocalMap</a> or <a class="el" href="class_rm_bayes_certainty_grid.html">RmBayesCertaintyGrid</a> via its constructor and <a class="el" href="class_rm_global_map.html#a10">update()</a> method. Internally, the difference between this and the <a class="el" href="class_rm_local_map.html">RmLocalMap</a> lies in the procedure by which the RmGlobalMap maintains a collection of <a class="el" href="class_rm_local_map.html">RmLocalMap</a> objects. Sonar readings are passed on to the current <a class="el" href="class_rm_local_map.html#a7">RmLocalMap::update()</a> method for processing until the distance traveled by the robot exceeds that prescribed by <a class="el" href="struct_rm_settings.html#o8">RmSettings::LocalMapDistance</a>. Once this occurs, the current local map is archived, and a new one is installed with the robot's current pose as its global origin, and processing resumes as before. <p>
<b>While not currently operational, it is intended that localization also occur as maps are archived.</b> For now, the #localize() method demonstrates the shift and rotation capabilities over all the local maps by shifting and rotating each one independently by the same amount. Repeated calls to #localize() continues the shift and rotation in the same direction. <p>
At any point, but presumably when all mapping has been completed, the collection of local maps can be integrated into a single map via <a class="el" href="class_rm_global_map.html#a6">integrate()</a>. The probability values in the cells of local maps that overlap each other are averaged. <h3>Dependencies</h3>
<p>
This class employs the utility structures of <a class="el" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a>, <a class="el" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a>, <a class="el" href="struct_rm_utility_1_1_pose.html">RmUtility::Pose</a> and <a class="el" href="struct_rm_utility_1_1_sonar_reading.html">RmUtility::SonarReading</a> and also utilizes the values <a class="el" href="struct_rm_settings.html#o8">RmSettings::LocalMapDistance</a> and <a class="el" href="class_rm_bayes_certainty_grid.html#s0">RmBayesCertaintyGrid::InitVal</a>. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8h-source.html#l00099">99</a> of file <a class="el" href="_rm_global_map_8h-source.html">RmGlobalMap.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a9" doxytag="RmGlobalMap::RmGlobalMap"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">RmGlobalMap::RmGlobalMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_rm_settings.html">RmSettings</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>s</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initializes a 0 x 0 global map with no associated local maps and the given settings. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00030">30</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_settings_8h-source.html#l00184">RmSettings::GridName</a>, and <a class="el" href="_rm_settings_8h-source.html#l00128">RmSettings::Localize</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="RmGlobalMap::~RmGlobalMap"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">RmGlobalMap::~<a class="el" href="class_rm_global_map.html">RmGlobalMap</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destroys all local maps created via <a class="el" href="class_rm_global_map.html#a10">update()</a>. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8h-source.html#l00135">135</a> of file <a class="el" href="_rm_global_map_8h-source.html">RmGlobalMap.h</a>.    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b0" doxytag="RmGlobalMap::addToRegionMap"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RmGlobalMap::addToRegionMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_rm_local_map.html">RmLocalMap</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>map</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds the given map to the global region map. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00049">49</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00169">RmBayesCertaintyGrid::bound()</a>, <a class="el" href="_rm_global_map_8h-source.html#l00117">RmGlobalMap::Region::boundary</a>, <a class="el" href="_rm_local_map_8h-source.html#l00133">RmLocalMap::cumDistance()</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00212">deleteRegion()</a>, <a class="el" href="_rm_utility_8cpp-source.html#l00138">RmUtility::BoundBox::expandBy()</a>, <a class="el" href="_rm_global_map_8h-source.html#l00114">RmGlobalMap::Region::id</a>, <a class="el" href="_rm_global_map_8h-source.html#l00120">RmGlobalMap::Region::maps</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00729">newRegion()</a>, <a class="el" href="_rm_global_map_8h-source.html#l00105">RegionId</a>, and <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00363">RmMutableCartesianGrid&lt; T &gt;::valueAt()</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00305">finalize()</a>, and <a class="el" href="_rm_global_map_8cpp-source.html#l00316">installNewMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="RmGlobalMap::bound"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual <a class="el" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> RmGlobalMap::bound           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the bound of the global map as it exists after integration. 
<p>
Prior to integration, the global map remains in its initialialized size and state.
<p>
Reimplemented from <a class="el" href="class_rm_bayes_certainty_grid.html#a0">RmBayesCertaintyGrid</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8h-source.html#l00191">191</a> of file <a class="el" href="_rm_global_map_8h-source.html">RmGlobalMap.h</a>.
<p>
References <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00169">RmBayesCertaintyGrid::bound()</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00412">integrate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="RmGlobalMap::clear"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual void RmGlobalMap::clear           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sets all cells in the global map back to their initialization value, leaving local maps untouched. 
<p>

<p>
Reimplemented from <a class="el" href="class_rm_bayes_certainty_grid.html#a1">RmBayesCertaintyGrid</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8h-source.html#l00164">164</a> of file <a class="el" href="_rm_global_map_8h-source.html">RmGlobalMap.h</a>.
<p>
References <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00134">RmBayesCertaintyGrid::clear()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="RmGlobalMap::clearMapString"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::string RmGlobalMap::clearMapString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bound</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Produces a log string that clears all coordinates within the given bound, for use with the map viewer application. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00159">159</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_utility_8h-source.html#l00193">RmUtility::BoundBox::lr</a>, <a class="el" href="_rm_utility_8h-source.html#l00190">RmUtility::BoundBox::ul</a>, <a class="el" href="_rm_utility_8h-source.html#l00068">RmUtility::Coord::x</a>, and <a class="el" href="_rm_utility_8h-source.html#l00071">RmUtility::Coord::y</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="RmGlobalMap::convolvedValueAt"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">float RmGlobalMap::convolvedValueAt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"> const</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the value that is the average of all probabilities across the local maps mapped to the given global x-y coordinate. 
<p>
Any empty cells, that is, those with the value <a class="el" href="class_rm_bayes_certainty_grid.html#s0">RmBayesCertaintyGrid::InitVal</a>, are excluded from the average. If the coordinate does not map to any local map, returns <a class="el" href="class_rm_bayes_certainty_grid.html#s0">RmBayesCertaintyGrid::InitVal</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00178">178</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00235">RmMutableCartesianGrid&lt; float &gt;::inBounds()</a>, <a class="el" href="_rm_global_map_8h-source.html#l00120">RmGlobalMap::Region::maps</a>, and <a class="el" href="_rm_global_map_8h-source.html#l00105">RegionId</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00412">integrate()</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00465">localizedPose()</a>, and <a class="el" href="_rm_global_map_8cpp-source.html#l00747">obstructionBetween()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="RmGlobalMap::deleteRegion"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RmGlobalMap::deleteRegion           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_rm_global_map_1_1_region.html">Region</a> **const &nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>r</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes the given region and removes it from the global region map. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00212">212</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_global_map_8cpp-source.html#l00264">fillRegionMap()</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00049">addToRegionMap()</a>, and <a class="el" href="_rm_global_map_8cpp-source.html#l00819">removeFromRegionMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="RmGlobalMap::empty"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RmGlobalMap::empty           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Removes all local maps and reduces the global map back to its initialization size and state. 
<p>

<p>
Reimplemented from <a class="el" href="class_rm_bayes_certainty_grid.html#a2">RmBayesCertaintyGrid</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00232">232</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00247">RmMutableCartesianGrid&lt; T &gt;::empty()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="RmGlobalMap::fillRegionMap"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RmGlobalMap::fillRegionMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="struct_rm_global_map_1_1_region.html">Region</a> *const &nbsp;</td>
          <td class="mdname" nowrap> <em>r</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="class_rm_global_map.html#w0">RegionId</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>id</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fills the area of region r over the global region map with the given id. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00264">264</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_global_map_8h-source.html#l00117">RmGlobalMap::Region::boundary</a>, <a class="el" href="_rm_global_map_8h-source.html#l00120">RmGlobalMap::Region::maps</a>, <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00560">RmMutableCartesianGrid&lt; T &gt;::put()</a>, <a class="el" href="_rm_global_map_8h-source.html#l00105">RegionId</a>, and <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00363">RmMutableCartesianGrid&lt; T &gt;::valueAt()</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00212">deleteRegion()</a>, and <a class="el" href="_rm_global_map_8cpp-source.html#l00729">newRegion()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="RmGlobalMap::finalize"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RmGlobalMap::finalize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Performs housekeeping on last open local map and integrates all maps into the global map. 
<p>
Further attempts to <a class="el" href="class_rm_global_map.html#a10">update()</a> are ignored until until reset by call to <a class="el" href="class_rm_global_map.html#a3">empty()</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00305">305</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_global_map_8cpp-source.html#l00049">addToRegionMap()</a>, and <a class="el" href="_rm_global_map_8cpp-source.html#l00412">integrate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="RmGlobalMap::height"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int RmGlobalMap::height           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the height of the global map as it exists after integration. 
<p>
Prior to integration, the global map remains in its initialialized size and state.
<p>
Reimplemented from <a class="el" href="class_rm_bayes_certainty_grid.html#a3">RmBayesCertaintyGrid</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8h-source.html#l00184">184</a> of file <a class="el" href="_rm_global_map_8h-source.html">RmGlobalMap.h</a>.
<p>
References <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00163">RmBayesCertaintyGrid::height()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="RmGlobalMap::installNewMap"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::string RmGlobalMap::installNewMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="struct_rm_utility_1_1_sonar_reading.html">RmUtility::SonarReading</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>reading</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Creates and adds a new local map to collection of maps, and dispatches any housekeeping chores. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>reading</em>&nbsp;</td><td>an unscaled sonar reading </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>string of coordinate-probability pairs that identify all cells affected by the operation</dd></dl>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00316">316</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_global_map_8cpp-source.html#l00049">addToRegionMap()</a>, <a class="el" href="_rm_utility_8cpp-source.html#l00087">RmUtility::Coord::angleTo()</a>, <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00169">RmBayesCertaintyGrid::bound()</a>, <a class="el" href="_rm_settings_8h-source.html#l00109">RmSettings::CellSize</a>, <a class="el" href="_rm_utility_8h-source.html#l00245">RmUtility::Pose::coord</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00412">integrate()</a>, <a class="el" href="_rm_settings_8h-source.html#l00128">RmSettings::Localize</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00465">localizedPose()</a>, <a class="el" href="_rm_local_map_8h-source.html#l00127">RmLocalMap::pose()</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00819">removeFromRegionMap()</a>, <a class="el" href="_rm_local_map_8cpp-source.html#l00078">RmLocalMap::reorientBy()</a>, <a class="el" href="_rm_utility_8h-source.html#l00320">RmUtility::SonarReading::robotPose</a>, <a class="el" href="_rm_utility_8h-source.html#l00084">RmUtility::Coord::scaled()</a>, <a class="el" href="_rm_utility_8h-source.html#l00264">RmUtility::Pose::scaled()</a>, and <a class="el" href="_rm_utility_8h-source.html#l00248">RmUtility::Pose::theta</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00852">update()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="RmGlobalMap::integrate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const std::string RmGlobalMap::integrate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const RmPolygon &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>bound</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>retVal</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convolves the given local map with the global map. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bound</em>&nbsp;</td><td>the boundary that defines the area to integrate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>retVal</em>&nbsp;</td><td>if false, an update string is not built and the return value is an empty string </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>string of coordinate-probability pairs that identify all non-empty cells in the format <code>x y pr;x y pr;...</code>; see <a class="el" href="class_rm_bayes_certainty_grid.html#a6">RmBayesCertaintyGrid::update( const RmUtility::MappedSonarReading &amp;reading )</a></dd></dl>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00428">428</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_global_map_8cpp-source.html#l00178">convolvedValueAt()</a>, and <a class="el" href="class_rm_mutable_cartesian_grid.html#a18">RmMutableCartesianGrid&lt; float &gt;::valueAt()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="RmGlobalMap::integrate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RmGlobalMap::integrate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Combines all local maps into a single global map, combining overlapping probabilities as an average. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00412">412</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00255">RmMutableCartesianGrid&lt; T &gt;::bound()</a>, <a class="el" href="_rm_global_map_8h-source.html#l00191">bound()</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00178">convolvedValueAt()</a>, <a class="el" href="_rm_utility_8h-source.html#l00193">RmUtility::BoundBox::lr</a>, <a class="el" href="_rm_global_map_8h-source.html#l00105">RegionId</a>, <a class="el" href="_rm_utility_8h-source.html#l00190">RmUtility::BoundBox::ul</a>, <a class="el" href="class_rm_mutable_cartesian_grid.html#a18">RmMutableCartesianGrid&lt; float &gt;::valueAt()</a>, <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00363">RmMutableCartesianGrid&lt; T &gt;::valueAt()</a>, <a class="el" href="_rm_utility_8h-source.html#l00068">RmUtility::Coord::x</a>, and <a class="el" href="_rm_utility_8h-source.html#l00071">RmUtility::Coord::y</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00305">finalize()</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00316">installNewMap()</a>, and <a class="el" href="_rm_global_map_8cpp-source.html#l00465">localizedPose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b6" doxytag="RmGlobalMap::localizedPose"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="struct_rm_utility_1_1_pose.html">Pose</a> RmGlobalMap::localizedPose           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_rm_local_map.html">RmLocalMap</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>priorMap</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="struct_rm_utility_1_1_sonar_reading.html">RmUtility::SonarReading</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>reading</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::ofstream &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>log</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"> const<code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the expected robot pose given the reported pose and sonar readings, terminating local map, and global map. 
<p>
A probabilistic motion model, akin to that described and illustrated in <em>Sonar-Based Mapping with Mobile Robots Using EM</em> (W. Burgard, et al, 1999), is computed as a Cartesian grid with its origin at the reported robot position. The cummulative distance and degrees of turn reported by the current local map determine the dimension of this pose distribution; a greater distance increases its height, a greater degree of turn increases its width. The motion model is represented as a horizontally-elongated Gaussian ellipsoid, with its east and west borders "pulled" down, forming a convex northern and concave southern border (see <a class="el" href="namespace_rm_utility.html#a6">RmUtility::gaussGrid()</a> figure B for an illustration and further details). Each cell within the motion model grid holds a normally-distributed probability.<p>
The in-range reading from each sonar is evaluated from each point in the global map that corresponds to a non-zero value in the motion model. The range reading vector is extended from this point as if the sonar were located in that position. If the path is unobstructed (as per the current global map), the value of that motion model cell is convolved with that cell's probability of occupancy (see <a class="el" href="class_rm_bayes_sonar_model.html#a0">RmBayesSonarModel::prOccupiedGivenSn()</a>). This combined pose likelihood value is retained in a second probabilistic Cartesian grid that is aligned with the motion model over the global map.<p>
After all pose likelihoods have been evaluated for a sonar, a third Cartesian grid--this one histogrammic--that is aligned with the reported robot pose over the global map, is updated. Each cell that corresponds to a cell in the pose likelihood grid with a maximum likelihood value is incremented by one. This same histogram is updated for each sonar. Once all sonars are processed, those cells with the maximum value indicate all possible localized poses.<p>
From these selected poses, those not associated with the maximum selected pose distribution are filtered out, thus theoretically leaving only one selected localized pose. The localized pose coordinate is identified by the corresponding coordinate on the global map; the pose theta is represented as the delta between the angle, <em>alpha</em>, from the current local map's pose coordinate to the new local map's <em>unlocalized</em> pose coordinate, and <em>beta</em>, from the current local map's pose coordinate to the new local map's <em>localized</em> coordinate. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>priorMap</em>&nbsp;</td><td>the local map that has been built but not yet convolved into the global map </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reading</em>&nbsp;</td><td>the first sonar reading of the new local map, unscaled </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>log</em>&nbsp;</td><td>the file to which localization log entries are sent; if the file is invalid or closed, no log entries are recorded </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>localized robot position and angle to that pos from starting position of the current local map, scaled</dd></dl>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00465">465</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_utility_8h-source.html#l00329">RmUtility::SonarReading::all</a>, <a class="el" href="_rm_utility_8cpp-source.html#l00087">RmUtility::Coord::angleTo()</a>, <a class="el" href="_rm_settings_8h-source.html#l00172">RmSettings::MotionModelStruct::BendFactor</a>, <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00255">RmMutableCartesianGrid&lt; T &gt;::bound()</a>, <a class="el" href="_rm_settings_8h-source.html#l00109">RmSettings::CellSize</a>, <a class="el" href="_rm_mutable_matrix_8h-source.html#l00422">RmMutableMatrix&lt; T &gt;::clear()</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00178">convolvedValueAt()</a>, <a class="el" href="_rm_utility_8h-source.html#l00245">RmUtility::Pose::coord</a>, <a class="el" href="class_rm_mutable_cartesian_grid.html#a1">RmMutableCartesianGrid&lt; float &gt;::copyInto()</a>, <a class="el" href="_rm_local_map_8h-source.html#l00133">RmLocalMap::cumDistance()</a>, <a class="el" href="_rm_local_map_8h-source.html#l00139">RmLocalMap::cumTurn()</a>, <a class="el" href="_rm_utility_8h-source.html#l00326">RmUtility::SonarReading::distance</a>, <a class="el" href="_rm_settings_8h-source.html#l00165">RmSettings::MotionModelStruct::GaussianSigma</a>, <a class="el" href="_rm_settings_8h-source.html#l00184">RmSettings::GridName</a>, <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00163">RmBayesCertaintyGrid::height()</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00412">integrate()</a>, <a class="el" href="_rm_utility_8h-source.html#l00193">RmUtility::BoundBox::lr</a>, <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00537">RmMutableCartesianGrid&lt; T &gt;::mergeWith()</a>, <a class="el" href="_rm_settings_8h-source.html#l00140">RmSettings::MotionModelStruct::MinHeight</a>, <a class="el" href="_rm_settings_8h-source.html#l00146">RmSettings::MotionModelStruct::MinWidth</a>, <a class="el" href="struct_rm_settings.html#o13">RmSettings::MotionModel</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00747">obstructionBetween()</a>, <a class="el" href="_rm_local_map_8h-source.html#l00127">RmLocalMap::pose()</a>, <a class="el" href="_rm_bayes_sonar_model_8cpp-source.html#l00030">RmBayesSonarModel::prOccupiedGivenSn()</a>, <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00560">RmMutableCartesianGrid&lt; T &gt;::put()</a>, <a class="el" href="_rm_pioneer_controller_8cpp-source.html#l00141">RmPioneerController::rangeReading()</a>, <a class="el" href="_rm_utility_8h-source.html#l00423">RmUtility::MappedSonarReading::scale()</a>, <a class="el" href="_rm_utility_8h-source.html#l00084">RmUtility::Coord::scaled()</a>, <a class="el" href="_rm_mutable_matrix_8h-source.html#l00162">RmMutableMatrix&lt; T &gt;::setInitValue()</a>, <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00355">RmMutableCartesianGrid&lt; T &gt;::setOrigin()</a>, <a class="el" href="_rm_utility_8h-source.html#l00323">RmUtility::SonarReading::sonarNumber</a>, <a class="el" href="_rm_utility_8h-source.html#l00190">RmUtility::BoundBox::ul</a>, <a class="el" href="_rm_settings_8h-source.html#l00152">RmSettings::MotionModelStruct::UnitDistance</a>, <a class="el" href="_rm_settings_8h-source.html#l00158">RmSettings::MotionModelStruct::UnitTurn</a>, <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00156">RmBayesCertaintyGrid::width()</a>, <a class="el" href="_rm_utility_8h-source.html#l00068">RmUtility::Coord::x</a>, and <a class="el" href="_rm_utility_8h-source.html#l00071">RmUtility::Coord::y</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00316">installNewMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="RmGlobalMap::newRegion"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="struct_rm_global_map_1_1_region.html">RmGlobalMap::Region</a> * RmGlobalMap::newRegion           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const RmPolygon &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bound</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Creates a new region over the given bound and adds it to the global region map. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00729">729</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_global_map_8cpp-source.html#l00264">fillRegionMap()</a>, and <a class="el" href="_rm_global_map_8h-source.html#l00105">RegionId</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00049">addToRegionMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="RmGlobalMap::obstructionBetween"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool RmGlobalMap::obstructionBetween           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>end</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"> const</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns true if there is a cell with a value of <a class="el" href="struct_rm_settings.html#o14">RmSettings::ObstructedCertainty</a> or greater on the line extending between the <em>scaled</em> start and end coordinates. 
<p>
Both the current local map and global map are considered when making this determination.
<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00747">747</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_global_map_8cpp-source.html#l00178">convolvedValueAt()</a>, <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00235">RmMutableCartesianGrid&lt; T &gt;::inBounds()</a>, <a class="el" href="_rm_settings_8h-source.html#l00177">RmSettings::ObstructedCertainty</a>, <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00363">RmMutableCartesianGrid&lt; T &gt;::valueAt()</a>, <a class="el" href="_rm_utility_8h-source.html#l00068">RmUtility::Coord::x</a>, and <a class="el" href="_rm_utility_8h-source.html#l00071">RmUtility::Coord::y</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00465">localizedPose()</a>, and <a class="el" href="_rm_global_map_8cpp-source.html#l00852">update()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="RmGlobalMap::put"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::ostream &amp; RmGlobalMap::put           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">std::ostream &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>os</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Inserts a text representation of this object into the given output stream. 
<p>
The local maps are first convolved with the global map.
<p>
Reimplemented from <a class="el" href="class_rm_bayes_certainty_grid.html#a4">RmBayesCertaintyGrid</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00806">806</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00147">RmBayesCertaintyGrid::put()</a>, and <a class="el" href="_rm_settings_8cpp-source.html#l00170">RmSettings::put()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b8" doxytag="RmGlobalMap::removeFromRegionMap"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RmGlobalMap::removeFromRegionMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_rm_local_map.html">RmLocalMap</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>map</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Removes the given map from the global region map. 
<p>

<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00819">819</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00169">RmBayesCertaintyGrid::bound()</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00212">deleteRegion()</a>, <a class="el" href="_rm_utility_8cpp-source.html#l00138">RmUtility::BoundBox::expandBy()</a>, <a class="el" href="_rm_global_map_8h-source.html#l00120">RmGlobalMap::Region::maps</a>, <a class="el" href="_rm_global_map_8h-source.html#l00105">RegionId</a>, and <a class="el" href="_rm_mutable_cartesian_grid_8h-source.html#l00363">RmMutableCartesianGrid&lt; T &gt;::valueAt()</a>.
<p>
Referenced by <a class="el" href="_rm_global_map_8cpp-source.html#l00316">installNewMap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="RmGlobalMap::update"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const std::string RmGlobalMap::update           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="struct_rm_utility_1_1_sonar_reading.html">RmUtility::SonarReading</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>reading</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Passes the given sonar reading on to the current <a class="el" href="class_rm_local_map.html">RmLocalMap</a>, creating a new local map once the distance specified by <a class="el" href="struct_rm_settings.html#o8">RmSettings::LocalMapDistance</a> has been traveled. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>the update string as returned by <a class="el" href="class_rm_local_map.html#a7">RmLocalMap::update()</a></dd></dl>

<p>
Reimplemented from <a class="el" href="class_rm_bayes_certainty_grid.html#a7">RmBayesCertaintyGrid</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8cpp-source.html#l00852">852</a> of file <a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a>.
<p>
References <a class="el" href="_rm_settings_8h-source.html#l00109">RmSettings::CellSize</a>, <a class="el" href="_rm_utility_8h-source.html#l00245">RmUtility::Pose::coord</a>, <a class="el" href="_rm_utility_8h-source.html#l00326">RmUtility::SonarReading::distance</a>, <a class="el" href="_rm_utility_8h-source.html#l00164">RmUtility::Coord::distanceFrom()</a>, <a class="el" href="_rm_bayes_certainty_grid_8cpp-source.html#l00333">RmBayesCertaintyGrid::gridCoord()</a>, <a class="el" href="_rm_settings_8h-source.html#l00096">RmSettings::IgnoreObstructed</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00316">installNewMap()</a>, <a class="el" href="_rm_settings_8h-source.html#l00128">RmSettings::Localize</a>, <a class="el" href="_rm_settings_8h-source.html#l00104">RmSettings::LocalMapDistance</a>, <a class="el" href="_rm_utility_8h-source.html#l00411">RmUtility::MappedSonarReading::objectCoord</a>, <a class="el" href="_rm_global_map_8cpp-source.html#l00747">obstructionBetween()</a>, <a class="el" href="_rm_pioneer_controller_8cpp-source.html#l00141">RmPioneerController::rangeReading()</a>, <a class="el" href="_rm_utility_8h-source.html#l00320">RmUtility::SonarReading::robotPose</a>, <a class="el" href="_rm_utility_8h-source.html#l00264">RmUtility::Pose::scaled()</a>, <a class="el" href="_rm_settings_8h-source.html#l00056">RmSettings::SonarModel</a>, <a class="el" href="_rm_utility_8h-source.html#l00323">RmUtility::SonarReading::sonarNumber</a>, <a class="el" href="_rm_utility_8h-source.html#l00408">RmUtility::MappedSonarReading::sonarPose</a>, <a class="el" href="_rm_utility_8h-source.html#l00248">RmUtility::Pose::theta</a>, and <a class="el" href="_rm_local_map_8cpp-source.html#l00006">RmLocalMap::update()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="RmGlobalMap::width"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int RmGlobalMap::width           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the width of the global map as it exists after integration. 
<p>
Prior to integration, the global map remains in its initialialized size and state.
<p>
Reimplemented from <a class="el" href="class_rm_bayes_certainty_grid.html#a8">RmBayesCertaintyGrid</a>.
<p>
Definition at line <a class="el" href="_rm_global_map_8h-source.html#l00177">177</a> of file <a class="el" href="_rm_global_map_8h-source.html">RmGlobalMap.h</a>.
<p>
References <a class="el" href="_rm_bayes_certainty_grid_8h-source.html#l00156">RmBayesCertaintyGrid::width()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="_rm_global_map_8h-source.html">RmGlobalMap.h</a><li>src/<a class="el" href="_rm_global_map_8cpp-source.html">RmGlobalMap.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sun Apr 3 16:46:54 2005 for Robot Mapper by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
