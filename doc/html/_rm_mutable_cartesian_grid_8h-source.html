<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Robot Mapper: include/RmMutableCartesianGrid.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a></div>
<h1>RmMutableCartesianGrid.h</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * RmMutableCartesianGrid.h</span>
00003 <span class="comment"> * </span>
00004 <span class="comment"> * Defines:</span>
00005 <span class="comment"> * - template&lt;class T&gt; class RmMutableCartesianGrid</span>
00006 <span class="comment"> * - template&lt;class T&gt; class Operator2D (internal use only)</span>
00007 <span class="comment"> * </span>
00008 <span class="comment"> * Purpose:</span>
00009 <span class="comment"> * Provides a two-dimensional grid based on the Cartesian coordinate system that is (optionally)</span>
00010 <span class="comment"> * dynamically and automatically expandable via subscripted access and assignment.  </span>
00011 <span class="comment"> * Coordinates given outside the bounds of the existing grid causes the grid to grow by the</span>
00012 <span class="comment"> * difference.</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> * An external "global" coordinate may be anchored to the local grid's origin (center cell) so</span>
00015 <span class="comment"> * that subscripts may be given with a global frame of reference.  Coordinates may also be</span>
00016 <span class="comment"> * specified using the local coordinate system.</span>
00017 <span class="comment"> *</span>
00018 <span class="comment"> * Author:</span>
00019 <span class="comment"> * Capt Kevin Owens</span>
00020 <span class="comment"> * Air Force Institute of Technology</span>
00021 <span class="comment"> *</span>
00022 <span class="comment"> * Revisions:</span>
00023 <span class="comment"> * 11 Nov 2004: created</span>
00024 <span class="comment"> * 12 Nov 2004: replaced grid structure with RmMutableMatrix&lt;T&gt;</span>
00025 <span class="comment"> *                              added support for CoordinateMode and ExpansionMode</span>
00026 <span class="comment"> * 18 Nov 2004: added bound()</span>
00027 <span class="comment"> * 19 Nov 2004: added empty() and initBounds()</span>
00028 <span class="comment"> * 21 Nov 2004: "const-ified" ostream&amp; operator&lt;&lt;()</span>
00029 <span class="comment"> * 27 Nov 2004: Moved MCGAccessor inside RmMutableCartesianGrid and renamed to Operator2D</span>
00030 <span class="comment"> *                              Added put() and valueAt(), calling from operator&lt;&lt; and operator[], respectively</span>
00031 <span class="comment"> *                              cppdoc documentation</span>
00032 <span class="comment"> * 15 Dec 2004: added trim(), const overloads to valueAt(), operator[], and Operator2D&lt;T&gt;</span>
00033 <span class="comment"> * 17 Dec 2004: added trimTo(), mergeWith(), origin()</span>
00034 <span class="comment"> * 19 Dec 2004: added copyAt()</span>
00035 <span class="comment"> * 21 Dec 2004: inherited from RmMutableMatrix&lt;T&gt;</span>
00036 <span class="comment"> *                              added operator=()</span>
00037 <span class="comment"> */</span>
00038 
00039 <span class="preprocessor">#ifndef RM_MUTABLE_CARTESIAN_GRID_H</span>
00040 <span class="preprocessor"></span><span class="preprocessor">#define RM_MUTABLE_CARTESIAN_GRID_H</span>
00041 <span class="preprocessor"></span>
00042 <span class="preprocessor">#include &lt;fstream&gt;</span>
00043 <span class="preprocessor">#include "RmMutableMatrix.h"</span>
00044 <span class="preprocessor">#include "RmUtility.h"</span>
00045 <span class="preprocessor">#include "RmExceptions.h"</span>
00046 
00047 
00102 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00103"></a><a class="code" href="class_rm_mutable_cartesian_grid.html">00103</a> <span class="keyword">class </span><a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid</a> : <span class="keyword">public</span> <a class="code" href="class_rm_mutable_matrix.html">RmMutableMatrix</a>&lt;T&gt;
00104 {
00105 <span class="keyword">public</span>:
00106 
<a name="l00108"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#w2">00108</a>         <span class="keyword">enum</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#w2">ExpansionMode</a> { 
00110                 Constrain, 
00112                 <a class="code" href="class_rm_mutable_cartesian_grid.html#w2w1">Expand</a> 
00113         };
00114 
<a name="l00116"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#n0">00116</a>         <span class="keyword">friend</span> <span class="keyword">class </span>Operator2D&lt;T&gt;; 
00117 
00118 
<a name="l00129"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a11">00129</a>         <a class="code" href="class_rm_mutable_cartesian_grid.html#a11">RmMutableCartesianGrid</a>( <span class="keywordtype">int</span> w = 10, <span class="keywordtype">int</span> h = 10, 
00130                 <span class="keyword">const</span> <a class="code" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a>&amp; globalOrigin = <a class="code" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a>(0,0), <span class="keyword">const</span> T initVal = T() )
00131                 : <a class="code" href="class_rm_mutable_matrix.html">RmMutableMatrix</a>&lt;T&gt;( w, h, initVal ),
00132                   m_globalOrigin( globalOrigin ), m_expandMode( Expand ) { <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">initBounds</a>( w, h ); }
00133 
00134 
00138         <a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid</a>&amp; <a class="code" href="class_rm_mutable_cartesian_grid.html#a6">operator=</a>( <span class="keyword">const</span> <a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid</a>&amp; source );
00139 
00140 
<a name="l00146"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a13">00146</a>         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a13">setExpansionMode</a>( ExpansionMode mode ) { m_expandMode = mode; }
00147 
00148 
00153         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a14">setOrigin</a>( <span class="keyword">const</span> RmUtility::Coord&amp; origin );
00154 
00155 
00160         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a10">resizeBy</a>( <span class="keywordtype">int</span> north, <span class="keywordtype">int</span> south, <span class="keywordtype">int</span> east, <span class="keywordtype">int</span> west );
00161 
00162 
00168         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a12">rotateBy</a>( <span class="keyword">const</span> <span class="keywordtype">double</span> theta );
00169 
00170 
00174         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a15">trim</a>();
00175 
00176 
00185         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a16">trimTo</a>( <span class="keyword">const</span> <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> bound );
00186 
00187 
00191         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a1">copyInto</a>( <a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid&lt;T&gt;</a>&amp; dest ) <span class="keyword">const</span>;
00192 
00193 
00198         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a5">mergeWith</a>( <span class="keyword">const</span> <a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid&lt;T&gt;</a>&amp; m );
00199 
00200 
00221         T&amp; <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y );
00222 
00223 
00229         <span class="keyword">const</span> T&amp; <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y ) <span class="keyword">const</span>;
00230 
00231 
<a name="l00235"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a4">00235</a>         <span class="keywordtype">bool</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a4">inBounds</a>( <span class="keyword">const</span> RmUtility::Coord &amp;c )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a4">inBounds</a>( c.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a>, c.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> ); }
00236 
00237 
00241         <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a4">inBounds</a>( <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y ) <span class="keyword">const</span>;
00242 
00243 
<a name="l00247"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a2">00247</a>         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a2">empty</a>() { <a class="code" href="class_rm_mutable_matrix.html#a1">RmMutableMatrix&lt;T&gt;::empty</a>(); <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">initBounds</a>( <a class="code" href="class_rm_mutable_matrix.html#a15">width</a>(), <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>() ); }
00248 
00249 
<a name="l00255"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a0">00255</a>         <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_globalBound; }
00256 
00257 
<a name="l00261"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a7">00261</a>         RmUtility::Coord <a class="code" href="class_rm_mutable_cartesian_grid.html#a7">origin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_globalOrigin; }
00262 
00263 
00270         std::ostream&amp; <a class="code" href="class_rm_mutable_cartesian_grid.html#a9">put</a>( std::ostream&amp; os, <span class="keywordtype">bool</span> bound = <span class="keyword">true</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *format = NULL ) <span class="keyword">const</span>;
00271 
00272 
00277         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a9">put</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* filename, <span class="keywordtype">int</span> precision = 4 ) <span class="keyword">const</span>;
00278 
00279 <span class="keyword">protected</span>:
00280 
00285         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">initBounds</a>( <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height );
00286 
00287 
00292         <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">initBounds</a>( RmUtility::Coord center );
00293 
00294 <span class="keyword">private</span>:
00295 
00297         RmUtility::Coord m_globalOrigin;
00298 
00300         RmUtility::Coord m_center;
00301 
00304         <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> m_globalBound;
00305 
00307         ExpansionMode m_expandMode;
00308 };
00309 
00310 
00311 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00312"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a6">00312</a> <a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid&lt;T&gt;</a>&amp; <a class="code" href="class_rm_mutable_cartesian_grid.html#a6">RmMutableCartesianGrid&lt;T&gt;::operator=</a>( <span class="keyword">const</span> <a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid</a>&amp; source )
00313 {
00314         <a class="code" href="class_rm_mutable_matrix.html#a4">RmMutableMatrix&lt;T&gt;::operator=</a>( source );
00315         m_globalOrigin = source.<a class="code" href="class_rm_mutable_cartesian_grid.html#r3">m_globalOrigin</a>;
00316         m_center = source.<a class="code" href="class_rm_mutable_cartesian_grid.html#r0">m_center</a>;
00317         m_globalBound = source.<a class="code" href="class_rm_mutable_cartesian_grid.html#r2">m_globalBound</a>;
00318         m_expandMode = source.<a class="code" href="class_rm_mutable_cartesian_grid.html#r1">m_expandMode</a>;
00319 
00320         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00321 }
00322 
00323 
00324 
00325 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00326"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#b1">00326</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">RmMutableCartesianGrid&lt;T&gt;::initBounds</a>( <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height )
00327 {
00328         <span class="keywordtype">int</span> h = height - 1;
00329         <span class="keywordtype">int</span> w = width - 1;
00330         m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> = w / 2;
00331         m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> = h / 2;
00332         <span class="keywordtype">int</span> yt = h - m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> + m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a>;
00333         <span class="keywordtype">int</span> xr = w - m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> + m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a>;
00334         <span class="keywordtype">int</span> xl = xr - w;
00335         <span class="keywordtype">int</span> yb = yt - h;
00336         m_globalBound = <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a>( xl, yt, xr, yb );
00337 }
00338 
00339 
00340 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00341"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#b0">00341</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">RmMutableCartesianGrid&lt;T&gt;::initBounds</a>( <a class="code" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a> center )
00342 {
00343         <span class="keywordtype">int</span> h = <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>() - 1;
00344         <span class="keywordtype">int</span> w = <a class="code" href="class_rm_mutable_matrix.html#a15">width</a>() - 1;
00345         m_center = center;
00346         <span class="keywordtype">int</span> yt = h - m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> + m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a>;
00347         <span class="keywordtype">int</span> xr = w - m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> + m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a>;
00348         <span class="keywordtype">int</span> xl = xr - w;
00349         <span class="keywordtype">int</span> yb = yt - h;
00350         m_globalBound = <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a>( xl, yt, xr, yb );
00351 }
00352 
00353 
00354 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00355"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a14">00355</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a14">RmMutableCartesianGrid&lt;T&gt;::setOrigin</a>( <span class="keyword">const</span> <a class="code" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a>&amp; origin )
00356 {
00357         m_globalOrigin = origin;
00358         <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">initBounds</a>( m_center );
00359 }
00360 
00361 
00362 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00363"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a18">00363</a> T&amp; <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">RmMutableCartesianGrid&lt;T&gt;::valueAt</a>( <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y )
00364 {
00365         <span class="comment">// Note: The m_center is anchored to m_gobalOrigin</span>
00366         <span class="comment">// Growing the grid up or to the left leaves that center unchanged</span>
00367         <span class="comment">// Growing the grid down or to the right by distance delta shifts the center up or down by the</span>
00368         <span class="comment">// same delta</span>
00369 
00370         <span class="keywordtype">bool</span> expanded = <span class="keyword">false</span>;
00371 
00372         <span class="comment">// Convert local/global coords to matrix indices</span>
00373         <span class="keywordtype">int</span> localX = m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> + x - m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a>;
00374         <span class="keywordtype">int</span> localY = m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> + y - m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a>;
00375 
00376         <span class="comment">// Expand grid as necessary and update bounds</span>
00377         <span class="comment">// ...left</span>
00378         <span class="keywordflow">if</span> ( localX &lt; 0 ) {
00379                 m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> += -localX;
00380                 m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x += localX;
00381                 expanded = <span class="keyword">true</span>;
00382         }
00383 
00384         <span class="comment">// ...right</span>
00385         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( localX &gt;= <a class="code" href="class_rm_mutable_matrix.html#a15">width</a>() ) {
00386                 m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x += localX - <a class="code" href="class_rm_mutable_matrix.html#a15">width</a>() + 1;
00387                 expanded = <span class="keyword">true</span>;
00388         }
00389 
00390         <span class="comment">// ...up</span>
00391         <span class="keywordflow">if</span> ( localY &gt;= <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>() ) {
00392                 m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y += localY - <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>() + 1;
00393                 expanded = <span class="keyword">true</span>;
00394         }
00395 
00396         <span class="comment">// ...down</span>
00397         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( localY &lt; 0 ) {
00398                 m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> += -localY;
00399                 m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y += localY;
00400                 expanded = <span class="keyword">true</span>;
00401         }
00402 
00403         <span class="keywordflow">if</span> ( expanded &amp;&amp; m_expandMode == Constrain ) {
00404                 <span class="keywordtype">char</span> buff[50];
00405                 sprintf( buff, <span class="stringliteral">"Index constraint: [%d..%d)[%d..%d); Requested index: [%d][%d]"</span>, 
00406                         m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x, m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x, m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y, m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y, x, y );
00407                 <span class="keywordflow">throw</span> <a class="code" href="struct_rm_exceptions_1_1_index_out_of_bounds_exception.html">RmExceptions::IndexOutOfBoundsException</a>( 
00408                         <span class="stringliteral">"RmMutableCartesianGrid&lt;T&gt;::valueAt()"</span>, buff );
00409         }
00410 
00411         <span class="comment">// Access grid using transposed coords</span>
00412         <span class="comment">// (from origin-lower-left to origin-upper-left)</span>
00413         <span class="keywordflow">return</span> <a class="code" href="class_rm_mutable_matrix.html#a14">RmMutableMatrix&lt;T&gt;::valueAt</a>( localX, <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>() - localY - 1 );
00414 }
00415 
00416 
00417 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00418"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a17">00418</a> <span class="keyword">const</span> T&amp; <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">RmMutableCartesianGrid&lt;T&gt;::valueAt</a>( <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y )<span class="keyword"> const</span>
00419 <span class="keyword"></span>{
00420         <span class="comment">// Note: The m_center is anchored to m_gobalOrigin</span>
00421         <span class="comment">// Growing the grid up or to the left leaves that center unchanged</span>
00422         <span class="comment">// Growing the grid down or to the right by distance delta shifts the center up or down by the </span>
00423         <span class="comment">// same delta</span>
00424 
00425         <span class="keywordtype">bool</span> expanded = <span class="keyword">false</span>;
00426 
00427         <span class="comment">// Convert local/global coords to matrix indices</span>
00428         <span class="keywordtype">int</span> localX = m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> + x - m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a>;
00429         <span class="keywordtype">int</span> localY = m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> + y - m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a>;
00430 
00431         <span class="comment">// Expand grid as necessary and update bounds</span>
00432         <span class="comment">// ...left</span>
00433         <span class="keywordflow">if</span> ( localX &lt; 0 || localX &gt;= <a class="code" href="class_rm_mutable_matrix.html#a15">width</a>() || localY &gt;= <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>() || localY &lt; 0 ) {
00434                 <span class="keywordtype">char</span> buff[50];
00435                 sprintf( buff, <span class="stringliteral">"Index constraint: [0..%d)[0..%d); Requested index: [%d][%d]"</span>, 
00436                         <a class="code" href="class_rm_mutable_matrix.html#a15">width</a>(), <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>(), x, y );
00437                 <span class="keywordflow">throw</span> <a class="code" href="struct_rm_exceptions_1_1_index_out_of_bounds_exception.html">RmExceptions::IndexOutOfBoundsException</a>( <span class="stringliteral">"RmMutableCartesianGrid&lt;T&gt;::valueAt() const"</span>, buff );
00438         }
00439 
00440         <span class="comment">// Access grid using transposed coords</span>
00441         <span class="comment">// (from origin-lower-left to origin-upper-left)</span>
00442         <span class="keywordflow">return</span> <a class="code" href="class_rm_mutable_matrix.html#a14">RmMutableMatrix&lt;T&gt;::valueAt</a>(localX, <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>() - localY - 1);
00443 }
00444 
00445 
00446 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00447"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a3">00447</a> <span class="keywordtype">bool</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a4">RmMutableCartesianGrid&lt;T&gt;::inBounds</a>( <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y )<span class="keyword"> const</span>
00448 <span class="keyword"></span>{
00449         <span class="keywordflow">return</span> x &gt;= m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x &amp;&amp; x &lt;= m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x &amp;&amp;
00450                 y &lt;= m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y &amp;&amp; y &gt;= m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y;
00451 }
00452 
00453 
00454 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00455"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a12">00455</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a12">RmMutableCartesianGrid&lt;T&gt;::rotateBy</a>( <span class="keyword">const</span> <span class="keywordtype">double</span> theta )
00456 {
00458         <span class="comment">// Resize grid such that origin is in physical center</span>
00459 
00460         <span class="comment">// find furthest boundary from origin</span>
00461         <span class="keywordtype">int</span> temp;
00462         <span class="keywordtype">int</span> horizMax = (temp = <a class="code" href="class_rm_mutable_matrix.html#a15">width</a>()-1 - m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a>) &gt; m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> ? temp : m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a>;
00463         <span class="keywordtype">int</span> vertMax = (temp = <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>()-1 - m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a>) &gt; m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> ? temp : m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a>;
00464                 <span class="comment">// Note: use the max of these two to square the grid about its center</span>
00465 
00466         <span class="comment">// punch out boundaries by that distance from the center</span>
00467         <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> - horizMax, m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> + vertMax );
00468         <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> + horizMax, m_globalOrigin.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> - vertMax );
00469 
00470 
00472         <span class="comment">// Rotate</span>
00473 
00474         <a class="code" href="class_rm_mutable_matrix.html#a10">RmMutableMatrix&lt;T&gt;::rotateBy</a>( theta );
00475 
00476         <span class="comment">// accommodate resizing that resulted from rotation</span>
00477         <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">initBounds</a>( <a class="code" href="class_rm_mutable_matrix.html#a15">width</a>(), <a class="code" href="class_rm_mutable_matrix.html#a2">height</a>() );
00478 }
00479 
00480 
00481 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00482"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a15">00482</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a15">RmMutableCartesianGrid&lt;T&gt;::trim</a>()
00483 {
00484         <span class="keyword">const</span> T <a class="code" href="class_rm_mutable_cartesian_grid.html#a2">empty</a> = <a class="code" href="class_rm_mutable_matrix.html#a3">initValue</a>();
00485         <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> inner( m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>, m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a> ); 
00486                 <span class="comment">// reversed intentionally to force update</span>
00487 
00488         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> y = m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y; y &gt; m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y; --y ) {
00489                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> x = m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x; x &lt; m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x; ++x ) {
00490                         <span class="keywordflow">if</span> ( <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( x, y ) != empty ) {
00491                                 <span class="keywordflow">if</span> ( x &lt; inner.ul.x ) inner.ul.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> = x;
00492                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( x &gt; inner.lr.x ) inner.lr.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> = x;
00493                                 <span class="keywordflow">if</span> ( y &gt; inner.ul.y ) inner.ul.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> = y;
00494                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( y &lt; inner.lr.y ) inner.lr.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> = y;
00495                         }
00496                 }
00497         }
00498 
00499         <a class="code" href="class_rm_mutable_cartesian_grid.html#a10">resizeBy</a>( inner.ul.y - m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y, m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y - inner.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y, 
00500                 inner.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x - m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x, m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x - inner.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x );
00501 }
00502 
00503 
00504 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00505"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a16">00505</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a16">RmMutableCartesianGrid&lt;T&gt;::trimTo</a>( <span class="keyword">const</span> <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> bound )
00506 {
00507         <span class="keywordtype">int</span> n = bound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y - m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y;
00508         <span class="keywordflow">if</span> ( n &gt; 0 ) n = 0;
00509         <span class="keywordtype">int</span> s = m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y - bound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y;
00510         <span class="keywordflow">if</span> ( s &gt; 0 ) s = 0;
00511         <span class="keywordtype">int</span> e = bound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x - m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x;
00512         <span class="keywordflow">if</span> ( e &gt; 0 ) e = 0;
00513         <span class="keywordtype">int</span> w = m_globalBound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x - bound.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x;
00514         <span class="keywordflow">if</span> ( w &gt; 0 ) w = 0;
00515 
00516         <a class="code" href="class_rm_mutable_cartesian_grid.html#a10">resizeBy</a>( n, s, e, w );
00517 }
00518 
00519 
00520 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00521"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a1">00521</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a1">RmMutableCartesianGrid&lt;T&gt;::copyInto</a>( <a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid&lt;T&gt;</a>&amp; dest )<span class="keyword"> const</span>
00522 <span class="keyword"></span>{
00523         <span class="comment">// Get requested bounds as fit within this grid</span>
00524         <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>( dest.<a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>() );
00525         <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#a5">intersectWith</a>( m_globalBound );
00526 
00527         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> y = <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y; y &gt;= <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y; --y ) {
00528                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> x = <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x; x &lt;= <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x; ++x ) {
00529                         <span class="keyword">const</span> T v = <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( x, y ); <span class="comment">// make copy</span>
00530                         dest.<a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( x, y ) = v;
00531                 }
00532         }
00533 }
00534 
00535 
00536 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00537"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a5">00537</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a5">RmMutableCartesianGrid&lt;T&gt;::mergeWith</a>( <span class="keyword">const</span> <a class="code" href="class_rm_mutable_cartesian_grid.html">RmMutableCartesianGrid&lt;T&gt;</a>&amp; m )
00538 {
00539         <span class="keyword">const</span> T <a class="code" href="class_rm_mutable_cartesian_grid.html#a2">empty</a> = <a class="code" href="class_rm_mutable_matrix.html#a3">initValue</a>();
00540         <span class="keyword">const</span> <a class="code" href="struct_rm_utility_1_1_bound_box.html">RmUtility::BoundBox</a> <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>( m.<a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>() );
00541         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> y = <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.y; y &gt;= <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.y; --y ) {
00542                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> x = <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o1">ul</a>.x; x &lt;= <a class="code" href="class_rm_mutable_cartesian_grid.html#a0">bound</a>.<a class="code" href="struct_rm_utility_1_1_bound_box.html#o0">lr</a>.x; ++x ) {
00543                         <span class="keyword">const</span> T v = m.<a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( x, y );
00544                         <span class="keywordflow">if</span> ( v != empty ) <a class="code" href="class_rm_mutable_cartesian_grid.html#a18">valueAt</a>( x, y ) = v;
00545                 }
00546         }
00547 }
00548 
00549 
00550 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00551"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a10">00551</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a10">RmMutableCartesianGrid&lt;T&gt;::resizeBy</a>( <span class="keywordtype">int</span> north, <span class="keywordtype">int</span> south, <span class="keywordtype">int</span> east, <span class="keywordtype">int</span> west )
00552 {
00553         <a class="code" href="class_rm_mutable_matrix.html#a8">RmMutableMatrix&lt;T&gt;::resizeBy</a>( north, south, east, west );
00554 
00555         <a class="code" href="class_rm_mutable_cartesian_grid.html#b1">initBounds</a>( <a class="code" href="class_rm_utility_1_1_coord.html">RmUtility::Coord</a>( m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o0">x</a> + west, m_center.<a class="code" href="class_rm_utility_1_1_coord.html#o1">y</a> + south ) );
00556 }
00557 
00558 
00559 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00560"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a9">00560</a> std::ostream&amp; <a class="code" href="class_rm_mutable_cartesian_grid.html#a9">RmMutableCartesianGrid&lt;T&gt;::put</a>( 
00561         std::ostream&amp; os, <span class="keywordtype">bool</span> bound, <span class="keyword">const</span> <span class="keywordtype">char</span> *format )<span class="keyword"> const</span>
00562 <span class="keyword"></span>{
00563         <span class="keywordflow">if</span> ( bound ) os &lt;&lt; m_globalBound &lt;&lt; <span class="stringliteral">"\n"</span>;
00564         <span class="keywordflow">return</span> <a class="code" href="class_rm_mutable_matrix.html#a7">RmMutableMatrix&lt;T&gt;::put</a>( os, format ); 
00565 }
00566 
00567 
00568 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00569"></a><a class="code" href="class_rm_mutable_cartesian_grid.html#a8">00569</a> <span class="keywordtype">void</span> <a class="code" href="class_rm_mutable_cartesian_grid.html#a9">RmMutableCartesianGrid&lt;T&gt;::put</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* filename, <span class="keywordtype">int</span> precision )<span class="keyword"> const</span>
00570 <span class="keyword"></span>{
00571         std::ofstream ofs( filename );
00572         ofs.setf( std::ios_base::fixed, std::ios_base::floatfield );
00573         ofs.precision( precision );
00574         <a class="code" href="class_rm_mutable_cartesian_grid.html#a9">put</a>( ofs, <span class="keyword">true</span> );
00575         ofs.close();
00576 }
00577 
00578 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Apr 3 16:46:53 2005 for Robot Mapper by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
